<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>íƒœí’ 6ì‹œê°„ ë’¤ í’ì† ì˜ˆì¸¡</title>

  <!-- ê¸€ê¼´ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- ëª¨ë¸ ê·œì¹™ JS -->
  <script src="./models/decision_tree_rules.js"></script>

  <style>
    :root{
      --bg1:#0f172a;
      --bg2:#1e293b;
      --card:#0b1226cc;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --ok:#10b981;
      --danger:#ef4444;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; padding:32px;
      font-family:"Pretendard",system-ui;
      background:
        radial-gradient(1000px 700px at 20% 10%, rgba(103,232,249,.25), transparent 60%),
        radial-gradient(800px 600px at 80% 120%, rgba(167,139,250,.25), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      color:var(--text);
      display:flex; justify-content:center; align-items:center;
      min-height:100vh;
    }
    .wrap{width:min(960px,100%);animation:fadeIn .7s ease both;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
    .title{display:flex;align-items:center;gap:14px;margin-bottom:10px;}
    .logo{
      width:42px;height:42px;border-radius:12px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:var(--shadow);display:grid;place-items:center;
      font-weight:800;color:#0b1226;
    }
    h1{margin:0;font-size:clamp(1.3rem,2.4vw,2rem);}
    .subtitle{color:var(--muted);margin:6px 0 18px;font-size:.96rem;}
    .card{
      background:var(--card);backdrop-filter:blur(12px);
      border:1px solid rgba(148,163,184,.25);
      border-radius:var(--radius);padding:22px;
      box-shadow:var(--shadow);
    }
    .grid{display:grid;gap:14px;}
    @media(min-width:720px){.grid{grid-template-columns:repeat(2,1fr);}}
    .field{display:flex;flex-direction:column;gap:8px;background:rgba(2,6,23,.35);
      border:1px solid rgba(148,163,184,.25);padding:12px;border-radius:12px;}
    label{font-weight:600;font-size:.95rem;}
    input,select{
      padding:12px;border:1px solid rgba(148,163,184,.2);
      border-radius:10px;background:rgba(15,23,42,.6);
      color:var(--text);font-size:16px;outline:none;
    }
    input:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(110,231,255,.15);}
    .actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px;}
    button{
      border:0;border-radius:12px;padding:12px 16px;cursor:pointer;
      font-weight:700;transition:.15s ease all;
    }
    #predict{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#0b1226;box-shadow:0 12px 30px rgba(110,231,255,.25);}
    #predict:hover{transform:translateY(-1px);}
    #clear{background:rgba(148,163,184,.18);color:var(--text);border:1px solid rgba(148,163,184,.25);}
    #example{background:rgba(167,139,250,.2);color:var(--text);border:1px solid rgba(167,139,250,.3);}
    .ranges{margin:14px 4px 0;color:var(--muted);font-size:.92rem;}
    .result{margin-top:18px;font-size:1.05rem;font-weight:700;
      padding:14px 16px;border-radius:12px;background:rgba(2,6,23,.45);
      border:1px solid rgba(148,163,184,.25);}
    .result.ok{color:var(--ok);border-color:rgba(16,185,129,.35);}
    .result.err{color:var(--danger);border-color:rgba(239,68,68,.35);}
    .grade{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;font-weight:700;font-size:.92rem;
      border:1px solid rgba(148,163,184,.25);background:rgba(2,6,23,.45);
    }
    .dot{width:10px;height:10px;border-radius:999px;background:#999;}
    footer{margin-top:16px;color:var(--muted);font-size:.88rem;text-align:center;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">
      <div class="logo">ğŸŒ€</div>
      <h1>íƒœí’ 6ì‹œê°„ ë’¤ í’ì† ì˜ˆì¸¡</h1>
    </div>
    <div class="subtitle">í˜„ì¬ ìƒíƒœ 4ê°€ì§€ë¥¼ ì…ë ¥í•˜ë©´, ë¸Œë¼ìš°ì €ì—ì„œ ì¦‰ì‹œ ì˜ˆì¸¡í•©ë‹ˆë‹¤. (ê²°ì •íŠ¸ë¦¬ ëª¨ë¸)</div>

    <div class="card">
      <div class="grid">
        <div class="field">
          <label for="wind">í˜„ì¬ ìµœëŒ€í’ì†</label>
          <div style="display:flex;gap:8px;">
            <input id="wind" type="number" step="0.1" placeholder="ì˜ˆ: 50" inputmode="decimal" style="flex:1;">
            <select id="windUnit" aria-label="wind unit">
              <option value="kt" selected>kt</option>
              <option value="mps">m/s</option>
            </select>
          </div>
        </div>
        <div class="field">
          <label for="pressure">ì¤‘ì‹¬ê¸°ì•• (hPa)</label>
          <input id="pressure" type="number" step="0.1" placeholder="ì˜ˆ: 970" inputmode="decimal">
        </div>
        <div class="field">
          <label for="lat">ìœ„ë„ (Â°N)</label>
          <input id="lat" type="number" step="0.01" placeholder="ì˜ˆ: 25.2" inputmode="decimal">
        </div>
        <div class="field">
          <label for="lon">ê²½ë„ (Â°E)</label>
          <input id="lon" type="number" step="0.01" placeholder="ì˜ˆ: 126.3" inputmode="decimal">
        </div>
      </div>

      <div class="actions">
        <button id="predict">ì˜ˆì¸¡í•˜ê¸°</button>
        <button id="clear">ì§€ìš°ê¸°</button>
        <button id="example">ì˜ˆì‹œ ìë™ì…ë ¥</button>
      </div>

      <div class="ranges">ê¶Œì¥ ë²”ìœ„ Â· í’ì† 0â€“120 kt Â· ê¸°ì•• 880â€“1040 hPa Â· ìœ„ë„ 0â€“60N Â· ê²½ë„ 100â€“160E</div>
      <div class="result" id="result">ì…ë ¥ í›„ â€œì˜ˆì¸¡í•˜ê¸°â€ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
      <div id="grade" class="grade"></div>
    </div>

    <footer>ëª¨ë¸: DecisionTreeRegressor Â· ë‹¨ìœ„ ë³€í™˜: kt â†” m/s Â· ë¸Œë¼ìš°ì €ì—ì„œ ì˜¤í”„ë¼ì¸ ì˜ˆì¸¡</footer>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const RANGES = {
      wind:{min:0,max:120}, pressure:{min:880,max:1040}, lat:{min:0,max:60}, lon:{min:100,max:160}
    };
    const inRange=(v,{min,max})=> v>=min && v<=max;

    // í’ì†(m/s)ì— ë”°ë¥¸ ë“±ê¸‰
    function gradeWind(y_mps){
      if (y_mps < 17.2) return {label:"ì•½í•¨(ì—´ëŒ€ì €ê¸°ì••)",color:"#60a5fa",desc:"ê°•ìˆ˜Â·ëŒí’ ê°€ëŠ¥ì„± ìˆìœ¼ë‚˜ í”¼í•´ ì ìŒ"};
      if (y_mps < 24.5) return {label:"ë³´í†µ(ì—´ëŒ€í­í’)",color:"#34d399",desc:"í•´ìƒÂ·ì•¼ì™¸í™œë™ ì£¼ì˜"};
      if (y_mps < 32.7) return {label:"ê°•í•¨(ê°•í•œ ì—´ëŒ€í­í’)",color:"#f59e0b",desc:"ê°•í’Â·í˜¸ìš° ëŒ€ë¹„ í•„ìš”"};
      return {label:"ë§¤ìš° ê°•í•¨(íƒœí’)",color:"#ef4444",desc:"ê´‘ë²”ìœ„í•œ í”¼í•´ ê°€ëŠ¥ì„±, ì² ì € ëŒ€ë¹„ í•„ìš”"};
    }

    function getInputs(){
      return {
        windVal: parseFloat($("wind").value),
        windUnit: $("windUnit").value,
        pressure: parseFloat($("pressure").value),
        lat: parseFloat($("lat").value),
        lon: parseFloat($("lon").value),
      };
    }

    function validate({windVal, windUnit, pressure, lat, lon}){
      if ([windVal, pressure, lat, lon].some(v => Number.isNaN(v)))
        return "ëª¨ë“  ì…ë ¥ì„ ìˆ«ìë¡œ ì±„ì›Œì£¼ì„¸ìš”.";
      const windKt = (windUnit === "mps") ? (windVal / 0.514) : windVal;
      if (!inRange(windKt, RANGES.wind)) return `í’ì†(kt)ì€ ${RANGES.wind.min}~${RANGES.wind.max} ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
      if (!inRange(pressure, RANGES.pressure)) return `ê¸°ì••(hPa)ì€ ${RANGES.pressure.min}~${RANGES.pressure.max} ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
      if (!inRange(lat, RANGES.lat)) return `ìœ„ë„(Â°N)ëŠ” ${RANGES.lat.min}~${RANGES.lat.max} ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
      if (!inRange(lon, RANGES.lon)) return `ê²½ë„(Â°E)ëŠ” ${RANGES.lon.min}~${RANGES.lon.max} ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
      return null;
    }

    function predict(){
      const res = $("result");
      const box = $("grade");
      const inputs = getInputs();
      const err = validate(inputs);
      if (err){ res.textContent = err; res.className = "result err"; box.innerHTML=""; return; }
      const windKt = (inputs.windUnit === "mps") ? (inputs.windVal / 0.514) : inputs.windVal;

      try{
        const y_mps = predictNextWindMps(windKt, inputs.pressure, inputs.lat, inputs.lon);
        const y_kt  = y_mps / 0.514;
        res.innerHTML = `6ì‹œê°„ ë’¤ ì˜ˆì¸¡ í’ì†: <b>${y_mps.toFixed(2)} m/s</b> (â‰ˆ ${y_kt.toFixed(1)} kt)`;
        res.className = "result ok";

        const g = gradeWind(y_mps);
        box.innerHTML = `
          <span class="chip"><span class="dot" style="background:${g.color}"></span>${g.label}</span>
          <span class="chip" style="opacity:.9">${g.desc}</span>`;
      }catch(e){
        res.textContent = "ì˜ˆì¸¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."; res.className="result err"; box.innerHTML="";
      }
    }

    function clearAll(){
      ["wind","pressure","lat","lon"].forEach(id=>$(id).value="");
      $("windUnit").value="kt";
      $("result").textContent="ì…ë ¥ í›„ â€œì˜ˆì¸¡í•˜ê¸°â€ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.";
      $("result").className="result";
      $("grade").innerHTML="";
    }

    // ìë™ ì˜ˆì‹œ ì…ë ¥
    function fillExample(){
      $("wind").value = 50;
      $("windUnit").value = "kt";
      $("pressure").value = 970;
      $("lat").value = 25.2;
      $("lon").value = 126.3;
    }

    $("predict").addEventListener("click", predict);
    $("clear").addEventListener("click", clearAll);
    $("example").addEventListener("click", fillExample);
    ["wind","pressure","lat","lon"].forEach(id=>{
      $(id).addEventListener("keydown", e=>{ if(e.key==="Enter") predict(); });
    });
  </script>
</body>
</html>
