<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>태풍 6시간 뒤 풍속 예측</title>
  <style>
    body { max-width: 720px; margin: 40px auto; font-family: system-ui, sans-serif; line-height: 1.5; }
    h1 { margin-bottom: 8px; }
    .card { padding: 16px; border: 1px solid #ddd; border-radius: 12px; }
    label { display: block; margin: 12px 0 6px; font-weight: 600; }
    input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
    button { margin-top: 16px; padding: 10px 14px; border: 0; border-radius: 8px; cursor: pointer; }
    button#predict { background: #1f6feb; color: white; }
    .result { margin-top: 16px; font-size: 1.1rem; font-weight: 700; }
    .note { color: #666; font-size: 0.9rem; margin-top: 10px; }
    footer { margin-top: 32px; color: #666; font-size: 0.85rem; }
  </style>
  <!-- 모델 규칙 JS (Colab에서 만든 파일을 저장소의 models/ 폴더에 업로드해야 함) -->
  <script src="./models/decision_tree_rules.js"></script>
</head>
<body>
  <h1>태풍 6시간 뒤 풍속 예측</h1>
  <div class="card">
    <label for="wind">현재 최대풍속 (노트, kt)</label>
    <input id="wind" type="number" step="0.1" placeholder="예: 50" />

    <label for="pressure">중심기압 (hPa)</label>
    <input id="pressure" type="number" step="0.1" placeholder="예: 970" />

    <label for="lat">위도 (°N)</label>
    <input id="lat" type="number" step="0.01" placeholder="예: 25.2" />

    <label for="lon">경도 (°E)</label>
    <input id="lon" type="number" step="0.01" placeholder="예: 126.3" />

    <button id="predict">예측하기</button>

    <div class="result" id="result"></div>
    <div class="note">※ 출력 단위: m/s (6시간 뒤 최대풍속 예측치)</div>
  </div>

  <footer>
    <div>입력 유효범위 예시: 풍속 0–120 kt, 기압 880–1040 hPa, 위도 0–60N, 경도 100–160E (임의 가이드)</div>
  </footer>

<script>
  // 간단 헬퍼
  const $ = (id) => document.getElementById(id);

  // 권장 범위(임의 가이드)
  const RANGES = {
    wind:   {min: 0,   max: 120},   // kt
    pressure:{min: 880, max: 1040}, // hPa
    lat:    {min: 0,   max: 60},    // deg N
    lon:    {min: 100, max: 160}    // deg E
  };

  function inRange(v, {min, max}) { return v >= min && v <= max; }

  function getInputs() {
    const wind = parseFloat($("wind").value);
    const pressure = parseFloat($("pressure").value);
    const lat = parseFloat($("lat").value);
    const lon = parseFloat($("lon").value);
    return { wind, pressure, lat, lon };
  }

  function validate({wind, pressure, lat, lon}) {
    const missing = [wind, pressure, lat, lon].some(v => Number.isNaN(v));
    if (missing) return "모든 입력을 숫자로 채워주세요.";
    if (!inRange(wind, RANGES.wind))       return `풍속(kt)은 ${RANGES.wind.min}~${RANGES.wind.max} 범위로 입력해주세요.`;
    if (!inRange(pressure, RANGES.pressure)) return `기압(hPa)은 ${RANGES.pressure.min}~${RANGES.pressure.max} 범위로 입력해주세요.`;
    if (!inRange(lat, RANGES.lat))         return `위도(°N)는 ${RANGES.lat.min}~${RANGES.lat.max} 범위로 입력해주세요.`;
    if (!inRange(lon, RANGES.lon))         return `경도(°E)는 ${RANGES.lon.min}~${RANGES.lon.max} 범위로 입력해주세요.`;
    return null;
  }

  function predict() {
    const $res = $("result");
    const inputs = getInputs();
    const err = validate(inputs);
    if (err) { $res.textContent = err; $res.style.color = "#d32f2f"; return; }

    try {
      const y = predictNextWindMps(inputs.wind, inputs.pressure, inputs.lat, inputs.lon);
      $res.textContent = `6시간 뒤 예측 풍속: ${y.toFixed(2)} m/s`;
      $res.style.color = "#111";
    } catch (e) {
      console.error(e);
      $res.textContent = "예측 중 오류가 발생했습니다. 콘솔(F12)을 확인해주세요.";
      $res.style.color = "#d32f2f";
    }
  }

  // 클릭 & 엔터키 둘 다 지원
  $("predict").addEventListener("click", predict);
  ["wind","pressure","lat","lon"].forEach(id=>{
    $(id).addEventListener("keydown", (e)=>{
      if (e.key === "Enter") predict();
    });
  });
</script>
</body>

</html>
